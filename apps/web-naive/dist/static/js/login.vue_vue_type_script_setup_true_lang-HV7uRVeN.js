var B=(c,i,s)=>new Promise((h,m)=>{var p=t=>{try{u(s.next(t))}catch(n){m(n)}},l=t=>{try{u(s.throw(t))}catch(n){m(n)}},u=t=>t.done?h(t.value):Promise.resolve(t.value).then(p,l);u((s=s.apply(c,i)).next())});import{u as M,f as C,$ as a,I as V,g as $,J as F,K as A,L as N,G as P}from"./bootstrap-15weX-M7.js";import{T as I}from"./auth-title-DKQfyDXe.js";import{d as v,r as K,c as E,g as q,j as D,k as g,l as d,v as S,A as w,m as b,B as _,C as y,x as f,s as o,n as U,D as L,q as j}from"./index-index-BuHJYOY4.js";const x=["onKeydown"],z={key:0,class:"mb-6 flex justify-between"},G={class:"flex-center"},J=v({name:"AuthenticationLogin",__name:"login",props:{formSchema:{default:()=>[]},codeLoginPath:{default:"/auth/code-login"},forgetPasswordPath:{default:"/auth/forget-password"},loading:{type:Boolean,default:!1},qrCodeLoginPath:{default:"/auth/qrcode-login"},registerPath:{default:"/auth/register"},showCodeLogin:{type:Boolean,default:!0},showForgetPassword:{type:Boolean,default:!0},showQrcodeLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},showRememberMe:{type:Boolean,default:!0},showThirdPartyLogin:{type:Boolean,default:!0},subTitle:{default:""},title:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(c,{expose:i,emit:s}){console.log(M);const h=c,m=s,[p,l]=M(K({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:E(()=>h.formSchema),showDefaultActions:!1}));C();const u=`REMEMBER_ME_USERNAME_${location.hostname}`,t=localStorage.getItem(u)||"",n=q(!!t);function k(){return B(this,null,function*(){const{valid:e}=yield l.validate(),r=yield l.getValues();e&&(localStorage.setItem(u,n.value?r==null?void 0:r.username:""),m("submit",r))})}function R(){window.open("https://github.com/midoks/fastcdn","_blank")}return D(()=>{t&&l.setFieldValue("username",t)}),i({getFormApi:()=>l}),(e,r)=>(d(),g("div",{onKeydown:F(A(k,["prevent"]),["enter"])},[S(e.$slots,"title",{},()=>[w(I,null,{default:_(()=>[S(e.$slots,"title",{},()=>[y(f(e.title||`${o(a)("authentication.welcomeBack")}`),1)])]),_:3})]),w(o(p)),e.showRememberMe||e.showForgetPassword?(d(),g("div",z,[U("div",G,[e.showRememberMe?(d(),L(o(V),{key:0,checked:n.value,"onUpdate:checked":r[0]||(r[0]=T=>n.value=T),name:"rememberMe"},{default:_(()=>[y(f(o(a)("authentication.rememberMe")),1)]),_:1},8,["checked"])):b("",!0)]),e.showForgetPassword?(d(),g("span",{key:0,class:"vben-link text-sm font-normal",onClick:R},f(o(a)("authentication.forgetPassword")),1)):b("",!0)])):b("",!0),w(o($),{class:j([{"cursor-wait":e.loading},"w-full"]),loading:e.loading,"aria-label":"login",onClick:k},{default:_(()=>[y(f(e.submitButtonText||o(a)("common.login")),1)]),_:1},8,["class","loading"])],40,x))}}),W=v({name:"Login",__name:"login",setup(c){const i=N(),s=E(()=>[{component:"VbenInput",componentProps:{placeholder:a("authentication.usernameTip")},fieldName:"username",label:a("authentication.username"),rules:P().min(1,{message:a("authentication.usernameTip")})},{component:"VbenInputPassword",componentProps:{placeholder:a("authentication.password")},fieldName:"password",label:a("authentication.password"),rules:P().min(1,{message:a("authentication.passwordTip")})}]);return(h,m)=>(d(),L(o(J),{"form-schema":s.value,loading:o(i).loginLoading,onSubmit:o(i).authLogin},null,8,["form-schema","loading","onSubmit"]))}});export{W as _};
