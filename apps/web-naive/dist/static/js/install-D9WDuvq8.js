var u=(i,r,a)=>new Promise((m,t)=>{var s=o=>{try{l(a.next(o))}catch(p){t(p)}},n=o=>{try{l(a.throw(o))}catch(p){t(p)}},l=o=>o.done?m(o.value):Promise.resolve(o.value).then(s,n);l((a=a.apply(i,r)).next())});import{f as d,G as e,H as b,$ as f}from"./bootstrap-BO7TQOOQ.js";import{_ as g}from"./register.vue_vue_type_script_setup_true_lang-BBYfe87W.js";import{d as h,g as P,c as N,D as I,l as w,s as c}from"./index-index-CGxb6KVd.js";import"./auth-title-BLSViL8P.js";const S=h({name:"Install",__name:"install",setup(i){const r=d(),a=P(!1),m=N(()=>[{component:"VbenInput",componentProps:{placeholder:"请输入站点名称"},fieldName:"siteName",label:"站点名称",rules:e().min(1,{message:"请输入站点名称"}).default("FastCDN")},{component:"VbenInput",componentProps:{placeholder:"请输入站点URL"},fieldName:"siteUrl",label:"站点URL",rules:e().min(1,{message:"请输入站点URL"}).url({message:"请输入有效的URL"})},{component:"VbenInput",componentProps:{placeholder:"请输入管理员用户名"},fieldName:"adminUsername",label:"管理员用户名",rules:e().min(1,{message:"请输入管理员用户名"})},{component:"VbenInputPassword",componentProps:{passwordStrength:!0,placeholder:"请输入管理员密码"},fieldName:"adminPassword",label:"管理员密码",renderComponentContent(){return{strengthText:()=>"密码强度"}},rules:e().min(6,{message:"密码至少6位"})},{component:"VbenInputPassword",componentProps:{placeholder:"请确认管理员密码"},dependencies:{rules(s){const{adminPassword:n}=s;return e({required_error:"请确认密码"}).min(1,{message:"请确认密码"}).refine(l=>l===n,{message:"两次密码输入不一致"})},triggerFields:["adminPassword"]},fieldName:"confirmPassword",label:"确认密码"},{component:"VbenSelect",componentProps:{options:[{label:"MySQL",value:"mysql"},{label:"PostgreSQL",value:"postgresql"},{label:"SQLite",value:"sqlite"}],placeholder:"请选择数据库类型"},fieldName:"databaseType",label:"数据库类型",rules:e().min(1,{message:"请选择数据库类型"}).default("mysql")},{component:"VbenInput",componentProps:{placeholder:"请输入数据库主机"},fieldName:"databaseHost",label:"数据库主机",rules:e().min(1,{message:"请输入数据库主机"}).default("localhost")},{component:"VbenInputNumber",componentProps:{placeholder:"请输入数据库端口",min:1,max:65535},fieldName:"databasePort",label:"数据库端口",rules:b().min(1,{message:"端口号必须大于0"}).max(65535,{message:"端口号不能超过65535"}).default(3306)},{component:"VbenInput",componentProps:{placeholder:"请输入数据库名称"},fieldName:"databaseName",label:"数据库名称",rules:e().min(1,{message:"请输入数据库名称"}).default("fastcdn")},{component:"VbenInput",componentProps:{placeholder:"请输入数据库用户名"},fieldName:"databaseUsername",label:"数据库用户名",rules:e().min(1,{message:"请输入数据库用户名"})},{component:"VbenInputPassword",componentProps:{placeholder:"请输入数据库密码"},fieldName:"databasePassword",label:"数据库密码",rules:e().min(1,{message:"请输入数据库密码"})}]);function t(s){return u(this,null,function*(){if(!a.value){a.value=!0;try{console.log("Installing with data:",s),yield new Promise(n=>setTimeout(n,2e3)),r.push("/auth/login")}catch(n){console.error("Installation failed:",n)}finally{a.value=!1}}})}return(s,n)=>(w(),I(c(g),{"form-schema":m.value,loading:a.value,"submit-button-options":{content:c(f)("page.auth.installButton")},onSubmit:t},null,8,["form-schema","loading","submit-button-options"]))}});export{S as default};
